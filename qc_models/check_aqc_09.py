# spike check
'''
Spikes (‘bulleyes’) : the temperature value strongly deviating from the neighbor measurements above and below. 
This check is similar to several QC schemes (e.g., Cabanes et al. (2021); Liu et al. (2017); UNESCO-IOC (2010); Wong et al. (2020)).
Values identified as spike are flagged as 1
'''
import numpy as np
import numpy.ma as ma

def spike_check(depth,tem,meta):
    try:
        isData = np.logical_and(depth.mask == False, tem.mask == False)
    except:
        depth=ma.array(depth,mask=np.isnan(depth))
        tem = ma.array(tem, mask=np.isnan(tem))
        isData = np.logical_and(depth.mask == False, tem.mask == False)
        
    levels=meta.levels
    kflagt=np.zeros(levels,np.int)

    if (levels < 3):
        descrption = '<3 levels,no spike check'
        return kflagt

    spike=np.full(levels,np.nan)
    for i in range(1,levels-1):
        if(~isData[i]):
            continue
        depth13=depth[i+1]-depth[i-1]
        depth12=depth[i]-depth[i-1]
        depth23=depth[i+1]-depth[i]
        dzmax=50.0+depth[i]/10.0
        dzmax2=dzmax/2
        if(depth13 > dzmax or depth12 > dzmax2 or depth23 >dzmax2):
            continue

        v1=tem[i-1]
        v2=tem[i]
        v3=tem[i+1]

        a=0.5*(v3+v1)
        q1=abs(v2-a)
        q2=abs(0.5*(v3-v1))

        spike[i]=q1-q2

    #Set spike overall limits depends on depth interval: thershold
    # depth dependent thershold values
    spikemax=4.0
    index1=np.logical_and(spike>spikemax,depth<=1000)
    kflagt[index1]=1
    spikemax=3.0
    index1=np.logical_and(np.logical_and(spike>spikemax,depth>1000),depth<2000)
    kflagt[index1]=1
    spikemax=2.0
    index1=np.logical_and(spike>spikemax,depth>=2000)
    kflagt[index1]=1


    return kflagt

if __name__ == '__main__':
    import numpy as np
    # import aqc_constant as const
    depth=np.array([1,3,4,5,6,7,8,15])
    tem=np.array([28,27,26,3,25,24,23.5,23])

    class metaData(object):
        def __init__(self):
            pass

    # depth=[np.nan, np.nan, np.nan, np.nan, np.nan, 4.013790131, 4.682600021, 5.351359844, 6.02008009, 6.68874979, 7.357379913, 8.025959969, 8.694499969, 9.362990379, 10.03143978, 10.69983959, 11.3682003, 12.03651047, 12.70477962, 13.37300014, 14.04117966, 14.70930958, 15.3774004, 16.04544067, 16.71343994, 17.38138962, 18.04929924, 18.71715927, 19.38497925, 20.05274963, 20.72047997, 21.38816071, 22.05579948, 22.72339058, 23.39093971, 24.05843925, 24.72590065, 25.39331055, 26.06068039, 26.72800064, 27.39528084, 28.06250954, 28.72970009, 29.39683914, 30.06394005, 30.73098946, 31.39800072, 32.06496048, 32.73188019, 33.39875031, 34.06557846, 34.73236084, 35.39910126, 36.06578827, 36.73244095, 37.39904022, 38.06560135, 38.73210907, 39.39857864, 40.06499863, 40.73138046, 41.39770889, 42.06399918, 42.73023987, 43.3964386, 44.06259155, 44.72869873, 45.39476013, 46.06077957, 46.72674942, 47.39268112, 48.05855942, 48.72439957, 49.39019012, 50.05593872, 50.72164154, 51.38729858, 52.05290985, 52.71847916, 53.38399887, 54.04948044, 54.7149086, 55.38029861, 56.04563904, 56.71094131, 57.37619019, 58.04140091, 58.70655823, 59.37168121, 60.03675079, 60.70177841, 61.36676025, 62.03170013, 62.69659042, 63.36143875, 64.02623749, 64.69100189, 65.35571289, 66.02037811, 66.68499756, 67.34957886, 68.01410675, 68.6785965, 69.34304047, 70.00743866, 70.67179108, 71.33609772, 72.00035858, 72.6645813, 73.32875061, 73.99288177, 74.65695953, 75.32099915, 75.98499298, 76.64894104, 77.31284332, 77.97669983, 78.64051056, 79.30428314, 79.96800232, 80.63168335, 81.29531097, 81.95890045, 82.62243652, 83.28594208, 83.9493866, 84.6128006, 85.27616119, 85.93948364, 86.60275269, 87.26598358, 87.92916107, 88.59230042, 89.25538635, 89.91844177, 90.58144379, 91.24440002, 91.90731049, 92.5701828, 93.23300171, 93.89578247, 94.55850983, 95.22119904, 95.88384247, 96.54644012, 97.208992, 97.87149811, 98.53395844, 99.19638062, 99.85874939, 100.52108, 101.1833572, 101.8455963, 102.5077896, 103.1699371, 103.8320389, 104.4941025, 105.1561127, 105.8180771, 106.4800034, 107.1418762, 107.8037109, 108.4654999, 109.127243, 109.7889404, 110.450592, 111.1121979, 111.7737579, 112.4352798, 113.0967484, 113.7581787, 114.4195633, 115.0809021, 115.7421875, 116.4034424, 117.0646362, 117.7257996, 118.3869095, 119.0479813, 119.7089996, 120.3699799, 121.0309067, 121.691803, 122.3526382, 123.013443, 123.6741867, 124.3348999, 124.9955597, 125.6561813, 126.3167496, 126.9772797, 127.6377563, 128.2982025, 128.9585876, 129.6189423, 130.2792358, 130.9394989, 131.5997162, 132.2598724, 132.9199982, 133.5800781, 134.2401123, 134.9001007, 135.5600433, 136.2199402, 136.8797913, 137.5395966, 138.1993561, 138.8590851, 139.5187531, 140.1783752, 140.8379669, 141.4974976, 142.1569824, 142.8164368, 143.4758453, 144.1351929, 144.7945099, 145.4537811, 146.1130066, 146.7721863, 147.4313049, 148.0903931, 148.7494354, 149.4084473, 150.0673828, 150.7263031, 151.3851624, 152.0439758, 152.7027435, 153.3614807, 154.0201569, 154.6788025, 155.3373871, 155.9959412, 156.6544342, 157.3128967, 157.9713135, 158.6296844, 159.2879944, 159.9462738, 160.6045074, 161.2626953, 161.9208374, 162.5789337, 163.2369843, 163.8950043, 164.5529633, 165.2108765, 165.8687439, 166.5265808, 167.1843567, 167.8421021, 168.4997864, 169.1574402, 169.815033, 170.4725952, 171.1301117, 171.7875824, 172.4450073, 173.1023865, 173.7597046, 174.4170074, 175.074234, 175.7314453, 176.3885956, 177.0457001, 177.7027588, 178.359787, 179.0167542, 179.6736755, 180.3305664, 180.9873962, 181.6441956, 182.3009338, 182.9576416, 183.6143036, 184.2709045, 184.927475, 185.5839996, 186.2404785, 186.8969116, 187.553299, 188.2096405, 188.8659363, 189.5221863, 190.1784058, 190.8345642, 191.4906769, 192.1467438, 192.8027802, 193.4587555, 194.1147003, 194.7705841, 195.4264374, 196.0822449, 196.7380066, 197.3937073, 198.0493774, 198.7050018, 199.3605804, 200.0161133, 200.6716003, 201.3270416, 201.9824371, 202.6377869, 203.2931061, 203.9483643, 204.6035767, 205.2587433, 205.9138794, 206.5689545, 207.223999, 207.8789825, 208.5339355, 209.1888428, 209.8437042, 210.4985046, 211.1532745, 211.8079987, 212.462677, 213.1173096, 213.7718964, 214.4264374, 215.0809326, 215.7353973, 216.389801, 217.0441589, 217.6984863, 218.3527527, 219.0069733, 219.6611633, 220.3153076, 220.9693909, 221.6234436, 222.2774353, 222.9313965, 223.5853119, 224.2391815, 224.8930054, 225.5467834, 226.2005157, 226.8542023, 227.507843, 228.161438, 228.8149872, 229.4685059, 230.1219635, 230.7753754, 231.4287567, 232.082077, 232.7353668, 233.3885956, 234.0417938, 234.6949463, 235.3480377, 236.0010986, 236.6541138, 237.3070831, 237.9600067, 238.6128845, 239.2657166, 239.9185028, 240.5712433, 241.223938, 241.8765869, 242.5292053, 243.1817627, 243.8342743, 244.4867554, 245.1391754, 245.7915649, 246.4438934, 247.0961914, 247.7484436, 248.4006348, 249.0527954, 249.7049103, 250.3569794, 251.0090027, 251.6609802, 252.312912, 252.964798, 253.6166382, 254.2684326, 254.9201965, 255.5718994, 256.2235718, 256.8751831, 257.5267639, 258.1782837, 258.8297729, 259.4812012, 260.1325989, 260.7839355, 261.4352417, 262.0864868, 262.7377014, 263.3888855, 264.0400085, 264.6910706, 265.3421021, 265.993103, 266.644043, 267.2949524, 267.9458008, 268.5965881, 269.247345, 269.8980713, 270.5487366, 271.1993713, 271.8499451, 272.5004883, 273.151001, 273.8014526, 274.4518433, 275.1022034, 275.7525024, 276.402771, 277.053009, 277.703186, 278.353302, 279.0033875, 279.6534424, 280.3034363, 280.9533997, 281.603302, 282.2531738, 282.9029846, 283.5527649, 284.2024841, 284.8521729, 285.5018005, 286.1513977, 286.8009338, 287.4504395, 288.0999146, 288.7492981, 289.3986816, 290.0480042, 290.6972656, 291.3464966, 291.995697, 292.6448364, 293.2939453, 293.9429932, 294.5920105, 295.2409668, 295.8898926, 296.5387573, 297.1875916, 297.8363647, 298.4851074, 299.1337891, 299.7824402, 300.4310303, 301.0795898, 301.7281189, 302.3765869, 303.0249939, 303.6733704, 304.3217163, 304.9700012, 305.6182251, 306.266449, 306.9145813, 307.5627136, 308.2107544, 308.8587952, 309.5067444, 310.1546936, 310.8025513, 311.4504089, 312.098175, 312.7459412, 313.3936462, 314.0412903, 314.6889038, 315.3364868, 315.9840088, 316.6314697, 317.2789001, 317.9263, 318.5736389, 319.2209473, 319.8681946, 320.5154114, 321.1625671, 321.8096924, 322.4567566, 323.1037903, 323.7507629, 324.3977051, 325.0445862, 325.6914368, 326.3382263, 326.9849854, 327.6317139, 328.2783813, 328.9249878, 329.5715942, 330.2181091, 330.8645935, 331.5110474, 332.1574402, 332.8038025, 333.4501038, 334.0963745, 334.7425842, 335.3887634, 336.0348816, 336.6809692, 337.3269958, 337.9729919, 338.618927, 339.2648315, 339.9107056, 340.5565186, 341.2022705, 341.8479919, 342.4936829, 343.1393127, 343.7849121, 344.4304504, 345.0759277, 345.721405, 346.3667908, 347.012146, 347.6574707, 348.3027649, 348.9479675, 349.5931702, 350.2383118, 350.8833923, 351.5284424, 352.1734314, 352.8183899, 353.4633179, 354.1081848, 354.7529907, 355.3977661, 356.042511, 356.6871948, 357.3318481, 357.9764404, 358.6210022, 359.2655029, 359.9099731, 360.5543823, 361.198761, 361.8430786, 362.4873657, 363.1315918, 363.7757874, 364.4199524, 365.0640259, 365.7080994, 366.3521118, 366.9960938, 367.6400146, 368.2838745, 368.9277039, 369.5715027, 370.2152405, 370.8589478, 371.502594, 372.1462097, 372.7897644, 373.4332886, 374.0767517, 374.7201843, 375.3635559, 376.006897, 376.650177, 377.2934265, 377.9366455, 378.5798035, 379.2229004, 379.8659668, 380.5090027, 381.1519775, 381.7949219, 382.4378052, 383.0806274, 383.7234497, 384.3661804, 385.0089111, 385.6515503, 386.2941895, 386.9367371, 387.5792847, 388.2217712, 388.8641968, 389.5065918, 390.1489258, 390.7912292, 391.4335022, 392.0757141, 392.717865, 393.3599854, 394.0020752, 394.644104, 395.2861023, 395.9280396, 396.5699463, 397.211792, 397.8536072, 398.4953613, 399.137085, 399.7787476, 400.4203796, 401.0619507, 401.7034912, 402.3450012, 402.9864502, 403.6278381, 404.2691956, 404.9105225, 405.5517883, 406.1929932, 406.8341675, 407.4753113, 408.116394, 408.7574463, 409.3984375, 410.0393982, 410.6802979, 411.321167, 411.9619751, 412.6027527, 413.2434692, 413.8841553, 414.5248108, 415.1653748, 415.8059387, 416.4464417, 417.0869141, 417.7272949, 418.3676758, 419.0079956, 419.6482849, 420.2885132, 420.9287109, 421.5688477, 422.2089539, 422.848999, 423.4890137, 424.1289673, 424.7688904, 425.4087524, 426.048584, 426.6883545, 427.3280945, 427.967804, 428.6074524, 429.2470398, 429.8865967, 430.526123, 431.1655884, 431.8049927, 432.4443665, 433.0837097, 433.7229919, 434.3622437, 435.0014343, 435.6405945, 436.2796936, 436.9187622, 437.5577698, 438.1967468, 438.8356934, 439.4745483, 440.1134033, 440.7521973, 441.3909302, 442.0296326, 442.6683044, 443.3069153, 443.9454651, 444.5840149, 445.2224731, 445.8609009, 446.4992981, 447.1376343, 447.7759399, 448.4141846, 449.0523987, 449.6905518, 450.3286743, 450.9667358, 451.6047668, 452.2427673, 452.8807068, 453.5185852, 454.1564331, 454.7942505, 455.4320068, 456.0697021, 456.7073669, 457.3450012, 457.9825745, 458.6201172, 459.2575989, 459.89505, 460.5324402, 461.1697998, 461.8070984, 462.4443665, 463.0815735, 463.71875, 464.3558655, 464.9929504, 465.6300049, 466.2669983, 466.9039307, 467.5408325, 468.1777039, 468.8145142, 469.4512939, 470.0880127, 470.7246704, 471.3612976, 471.9978943, 472.6344299, 473.2709351, 473.9073792, 474.5437927, 475.1801453, 475.8164673, 476.4527588, 477.0889893, 477.7251587, 478.3612976, 478.9973755, 479.6334534, 480.2694397, 480.9053955, 481.5413208, 482.1771851, 482.8129883, 483.4487915, 484.0845032, 484.7202148, 485.355835, 485.9914551, 486.6269836, 487.2625122, 487.8979492, 488.5333862, 489.1687622, 489.8040771, 490.4393616, 491.074585, 491.7097778, 492.3449402, 492.9800415, 493.6151123, 494.2501221, 494.8850708, 495.519989, 496.1548767, 496.7897034, 497.4244995, 498.0592346, 498.6939392, 499.3285828, 499.9631958, 500.5977478, 501.2322693, 501.8667603, 502.5011902, 503.1355591, 503.7698975, 504.4041748, 505.0384521, 505.6726379, 506.3067932, 506.940918, 507.5749817, 508.2090149, 508.8429871, 509.4768982, 510.1108093, 510.7446289, 511.3784485, 512.012207, 512.645874, 513.279541, 513.913208, 514.5467529, 515.1802979, 515.8137817, 516.4472046, 517.0805664, 517.7139282, 518.347229, 518.9805298, 519.6137085, 520.2468872, 520.8800049, 521.5130615, 522.1461182, 522.7791138, 523.4120483, 524.0449219, 524.6777954, 525.3106079, 525.9433594, 526.5760498, 527.2087402, 527.8413696, 528.473938, 529.1065063, 529.7390137, 530.37146, 531.0038452, 531.6362305, 532.2684937, 532.9007568, 533.53302, 534.1651611, 534.7973022, 535.4293823, 536.0614624, 536.6934204, 537.3253784, 537.9572754, 538.5891724, 539.2210083, 539.8527222, 540.4844971, 541.1161499, 541.7478027, 542.3793945, 543.0109253, 543.6424561, 544.2739258, 544.9053345, 545.5366821, 546.1680298, 546.7992554, 547.430481, 548.0617065, 548.6928101, 549.3239136, 549.9550171, 550.5859985, 551.21698, 551.8479004, 552.4787598, 553.1095581, 553.7403564, 554.3710938, 555.00177, 555.6324463, 556.2630615, 556.8936157, 557.5241089, 558.1546021, 558.7849731, 559.4154053, 560.0457153, 560.6760254, 561.3062134, 561.9364624, 562.5665894, 563.1967163, 563.8267822, 564.4567871, 565.086731, 565.7166748, 566.3465576, 566.9763794, 567.6062012, 568.2359619, 568.8656616, 569.4953003, 570.124939, 570.7544556, 571.3839722, 572.0134888, 572.6428833, 573.2722778, 573.9016113, 574.5309448, 575.1602173, 575.7894287, 576.4185791, 577.0476685, 577.6767578, 578.3057861, 578.9347534, 579.5637207, 580.1925659, 580.8214111, 581.4502563, 582.0789795, 582.7077026, 583.3363647, 583.9650269, 584.5935669, 585.2221069, 585.8505859, 586.4790649, 587.1074219, 587.7357788, 588.3640747, 588.9923706, 589.6206055, 590.2487793, 590.8768921, 591.5049438, 592.1329956, 592.7609863, 593.388916, 594.0168457, 594.6447144, 595.272522, 595.9002686, 596.5280151, 597.1557007, 597.7833252, 598.4108887, 599.0384521, 599.6659546, 600.293396, 600.9207764, 601.5481567, 602.1754761, 602.8027344, 603.4299927, 604.0571899, 604.6843262, 605.3114014, 605.9384155, 606.5654297, 607.1923828, 607.8193359, 608.446167, 609.072998, 609.6997681, 610.3265381, 610.953186, 611.579834, 612.2064209, 612.8330078, 613.4594727, 614.0859375, 614.7124023, 615.3387451, 615.9650879, 616.5913696, 617.2175903, 617.843811, 618.4699097, 619.0960693, 619.7221069, 620.3480835, 620.9740601, 621.5999756, 622.2258911, 622.8516846, 623.477478, 624.1032104, 624.7289429, 625.3546143, 625.9802246, 626.6057739, 627.2312622, 627.8567505, 628.4821777, 629.1075439, 629.7329102, 630.3582153, 630.9834595, 631.6086426, 632.2338257, 632.8588867, 633.4840088, 634.1090088, 634.7340088, 635.3588867, 635.9838257, 636.6086426, 637.2334595, 637.8582153, 638.4829102, 639.1075439, 639.7321777, 640.3567505, 640.9812622, 641.6057739, 642.2302246, 642.8546143, 643.4789429, 644.1032104, 644.727478, 645.3516846, 645.9758911, 646.5999756, 647.2240601, 647.8480835, 648.4721069, 649.0960693, 649.7199097, 650.343811, 650.9675903, 651.5913696, 652.2150879, 652.8387451, 653.4624023, 654.0859375, 654.7094727, 655.3330078, 655.9564209, 656.579834, 657.203186, 657.8265381, 658.4497681, 659.072998, 659.696167, 660.3193359, 660.9423828, 661.5654297, 662.1884155, 662.8114014, 663.4343262, 664.0571899, 664.6799927, 665.3027344, 665.9254761, 666.5481567, 667.1707764, 667.793396, 668.4159546, 669.0384521, 669.6608887, 670.2833252, 670.9057007, 671.5280151, 672.1502686, 672.772522, 673.3947144, 674.0168457, 674.638916, 675.2609863, 675.8829956, 676.5049438, 677.1268921, 677.7487793, 678.3706055, 678.9923706, 679.6140747, 680.2357788, 680.8574219, 681.4790649, 682.1005859, 682.7221069, 683.3435669, 683.9650269, 684.5863647, 685.2077026, 685.8289795, 686.4502563, 687.0714111, 687.6925659, 688.3137207, 688.9347534, 689.5557861, 690.1767578, 690.7976685, 691.4185791, 692.0394287, 692.6602173, 693.2809448, 693.9016113, 694.5222778, 695.1428833, 695.7634888, 696.3839722, 697.0044556, 697.624939, 698.2453003, 698.8656616, 699.4859619, 700.1062012, 700.7263794, 701.3465576, 701.9666748, 702.586731, 703.2067871, 703.8267822, 704.4467163, 705.0665894, 705.6864624, 706.3062134, 706.9260254, 707.5457153, 708.1654053, 708.7849731, 709.4046021, 710.0241089, 710.6436157, 711.2630615, 711.8824463, 712.50177, 713.1210938, 713.7403564, 714.3595581, 714.9787598, 715.5979004, 716.21698, 716.8359985, 717.4550171, 718.0739136, 718.6928101, 719.3117065, 719.930481, 720.5492554, 721.1680298, 721.7866821, 722.4053345, 723.0239258, 723.6424561, 724.2609253, 724.8793945, 725.4978027, 726.1161499, 726.7344971, 727.3527222, 727.9710083, 728.5891724, 729.2072754, 729.8253784, 730.4434204, 731.0614624, 731.6793823, 732.2973022, 732.9151611, 733.53302, 734.1507568, 734.7684937, 735.3862305, 736.0038452, 736.62146, 737.2390137, 737.8565063, 738.473938, 739.0913696, 739.7087402, 740.3260498, 740.9433594, 741.5606079, 742.1777954, 742.7949219, 743.4120483, 744.0291138, 744.6461182, 745.2630615, 745.8800049, 746.4968872, 747.1137085, 747.7305298, 748.347229, 748.9639282, 749.5805664, 750.1972046, 750.8137817, 751.4302979, 752.0467529, 752.663208, 753.279541, 753.895874, 754.512207, 755.128418, 755.7446289, 756.3607788, 756.9769287, 757.5929565, 758.2089844, 758.8249512, 759.440918, 760.0568237, 760.6726685, 761.2884521, 761.9041748, 762.5198975, 763.1355591, 763.7511597, 764.3667603, 764.9822998, 765.5977783, 766.2131958, 766.8286133, 767.4439697, 768.0592651, 768.6744995, 769.2897339, 769.9049072, 770.5200195, 771.1350708, 771.7501221, 772.3651123, 772.9800415, 773.5949097, 774.2097778, 774.824585, 775.4393311, 776.0540771, 776.6687622, 777.2833862, 777.8979492, 778.5125122, 779.1270142, 779.7414551, 780.355835, 780.9702148, 781.5845337, 782.1987915, 782.8129883, 783.4271851, 784.0413208, 784.6553955, 785.2694702]
    # tem=[np.nan, np.nan, np.nan, np.nan, np.nan, 30.09000015, 30.01000023, 29.93000031, 29.87000084, 29.87000084, 29.76000023, 29.64999962, 29.61000061, 29.52000046, 29.54999924, 29.54000092, 29.54000092, 29.5, 29.48999977, 29.46999931, 29.40999985, 29.37999916, 29.38999939, 29.37000084, 29.36000061, 29.35000038, 29.38999939, 29.45999908, 29.5, 29.52000046, 29.54999924, 29.64999962, 29.63999939, 29.60000038, 29.54999924, 29.53000069, 29.38999939, 29.40999985, 29.39999962, 29.34000015, 29.30999947, 29.46999931, 29.40999985, 29.47999954, 29.54999924, 29.62000084, 29.48999977, 29.54999924, 29.70999908, 29.69000053, 29.64999962, 29.48999977, 29.37999916, 29.29999924, 29.34000015, 29.29000092, 29.27000046, 28.70999908, 29.11000061, 29.04999924, 29.10000038, 29, 29.02000046, 29.06999969, 29.06999969, 29.02000046, 28.94000053, 28.87999916, 28.78000069, 28.57999992, 28.47999954, 28.37000084, 28.23999977, 28.11000061, 28.01000023, 27.93000031, 27.69000053, 27.59000015, 27.53000069, 27.35000038, 27.22999954, 27.05999947, 26.86000061, 26.72999954, 26.40999985, 26.56999969, 26.45999908, 26.35000038, 26.27000046, 26.15999985, 25.95000076, 25.95999908, 25.95000076, 25.88999939, 25.81999969, 25.77000046, 25.76000023, 25.81999969, 25.82999992, 25.32999992, 25.51000023, 25.53000069, 24.77000046, 24.82999992, 25.18000031, 24.54000092, 23.96999931, 24.31999969, 24.29000092, 24.96999931, 25.43000031, 25.40999985, 25.34000015, 25.32999992, 25.29999924, 25.25, 25.15999985, 25.13999939, 25.02000046, 24.86000061, 24.77000046, 24.65999985, 24.13999939, 23.04999924, 23.46999931, 23.70000076, 23.87999916, 24.14999962, 23.25, 23.82999992, 23.72999954, 23.63999939, 23.79000092, 23.59000015, 23.40999985, 23.26000023, 21.80999947, 19.65999985, 22.12000084, 21.04000092, 21.11000061, 21.68000031, 21.12000084, 21.53000069, 21.67000008, 20.87999916, 21.56999969, 21.52000046, 21.45000076, 21.31999969, 21.35000038, 21.32999992, 21.39999962, 17.56999969, 19.59000015, 20.61000061, 19.95999908, 20.04000092, 20.29999924, 20.85000038, 20.79999924, 20.84000015, 20.79000092, 20.71999931, 20.01000023, 19.13999939, 18.85000038, 18.71999931, 18.09000015, 19.14999962, 19.04000092, 19.26000023, 19.34000015, 19.84000015, 19.87999916, 19.52000046, 19, 18.80999947, 19.19000053, 17.55999947, 12.28999996, 17.04999924, 16.84000015, 17.65999985, 16.87000084, 17.19000053, 17.80999947, 18.05999947, 18.29000092, 18.43000031, 18.06999969, 17.56999969, 17.46999931, 17.62999916, 18.20000076, 17.07999992, 17.87000084, 16.90999985, 17.23999977, 17.12000084, 16.94000053, 16.44000053, 16.12000084, 15.57999992, 15.92000008, 17.18000031, 17.30999947, 16.89999962, 17.04999924, 17.09000015, 16.82999992, 16.38999939, 16.53000069, 16.5, 16.19000053, 16.04999924, 15.27999973, 15.93999958, 15.80000019, 15.68000031, 15.64000034, 15.67000008, 15.71000004, 15.72999954, 15.67000008, 15.56999969, 15.40999985, 15.18000031, 14.77999973, 14.81999969, 14.71000004, 14.64999962, 14.21000004, 13.71000004, 14.57999992, 14.39999962, 14.47999954, 14.52000046, 13.86999989, 14.75, 14.52999973, 13.68999958, 13.28999996, 14.10000038, 13.18000031, 13.55000019, 13.82999992, 13.68000031, 13.39000034, 12.14999962, 11.23999977, 12.31999969, 11.68000031, 12.22999954, 13.39999962, 13.55000019, 13.55000019, 13.56999969, 13.56000042, 13.06999969, 13.10999966, 13.15999985, 12.86999989, 12.09000015, 11.80000019, 12.64000034, 10.73999977, 9.520000458, 7.489999771, 3.670000076, -1.5, 3.180000067, -3.809999943, -2.970000029, 1.870000005, 2.450000048, 6.010000229, 2.230000019, 5.369999886, 5.309999943, 6.739999771, 9.170000076, 9.989999771, 10.25, 10.06000042, 9.979999542, 9.869999886, 10.31999969, 11.77000046, 12.32999992, 12.31000042, 12.40999985, 12.42000008, 12.64999962, 12.56000042, 12.59000015, 12.46000004, 12.52000046, 12.39000034, 12.27000046, 12.03999996, 12.10999966, 12.06000042, 11.85999966, 11.94999981, 12.21000004, 12.26000023, 12.43000031, 12.35999966, 12.47999954, 12.43999958, 12.31000042, 12.19999981, 12.10000038, 12.26000023, 12.25, 12.42000008, 12.43000031, 12.28999996, 12.31000042, 12.26000023, 12.14999962, 12.22000027, 12.19999981, 12, 12.27000046, 12.32999992, 12.05000019, 12.09000015, 12.10999966, 12.10999966, 12.02000046, 12.02999973, 12.10999966, 12.39999962, 12.56999969, 12.64000034, 12.52000046, 12.36999989, 12.31000042, 12.23999977, 12.21000004, 12.22999954, 12.23999977, 12.25, 12.23999977, 12.15999985, 12.22999954, 12.31999969, 12.35999966, 12.31999969, 12.21000004, 12.14999962, 12.02000046, 11.90999985, 11.72000027, 11.89000034, 11.96000004, 12.06999969, 12.10000038, 12.03999996, 12.01000023, 12.05000019, 11.97000027, 11.98999977, 11.97000027, 11.93999958, 11.86999989, 11.89999962, 11.93000031, 11.89999962, 11.89999962, 11.94999981, 11.93000031, 11.89000034, 11.89999962, 11.84000015, 11.76000023, 11.77999973, 11.75, 11.77000046, 11.80000019, 11.75, 11.71000004, 11.72000027, 11.64000034, 11.64000034, 11.57999992, 11.68999958, 11.60999966, 11.60000038, 11.55000019, 11.57999992, 11.64000034, 11.64000034, 11.68999958, 11.67000008, 11.71000004, 11.68000031, 11.68999958, 11.68999958, 11.68000031, 11.61999989, 11.60000038, 11.52000046, 11.52999973, 11.47000027, 11.60000038, 11.60999966, 11.57999992, 11.64000034, 11.71000004, 11.72000027, 11.60000038, 11.64999962, 11.55000019, 11.48999977, 11.35999966, 11.30000019, 11.23999977, 11.31999969, 11.35999966, 11.38000011, 11.43000031, 11.18000031, 11.27999973, 11.18999958, 11.27000046, 11.31999969, 11.25, 11.23999977, 11.35000038, 11.34000015, 11.40999985, 11.32999992, 11.22000027, 11.22000027, 11.18000031, 11.09000015, 11.14999962, 11.19999981, 11.27000046, 11.22000027, 11.14000034, 11.18000031, 11.14000034, 11.10000038, 11.07999992, 10.93999958, 11.06999969, 10.98999977, 10.77000046, 11, 11.06999969, 11.06999969, 11.01000023, 11.10000038, 11.10000038, 11.07999992, 11.11999989, 11.05000019, 11.03999996, 10.86999989, 10.90999985, 11.10000038, 11.14000034, 11.17000008, 11.17000008, 11.14000034, 11.10999966, 11.10999966, 11.09000015, 11.06000042, 11.03999996, 11.05000019, 11.02000046, 11.02000046, 11, 10.92000008, 10.94999981, 10.94999981, 10.93999958, 10.94999981, 10.93999958, 10.84000015, 10.85999966, 10.78999996, 10.75, 10.81999969, 10.68999958, 10.73999977, 10.81000042, 10.80000019, 10.81999969, 10.69999981, 10.75, 10.71000004, 10.80000019, 10.85000038, 10.90999985, 10.94999981, 10.93000031, 10.88000011, 10.92000008, 10.92000008, 10.93000031, 10.92000008, 10.93000031, 11.01000023, 10.97999954, 11.02000046, 11, 10.93000031, 10.89000034, 10.84000015, 10.88000011, 10.85999966, 10.85999966, 10.86999989, 10.85000038, 10.88000011, 10.72999954, 10.77999973, 10.73999977, 10.75, 10.81000042, 10.80000019, 10.76000023, 10.69999981, 10.65999985, 10.68999958, 10.65999985, 10.59000015, 10.48999977, 10.44999981, 10.42000008, 10.32999992, 10.47999954, 10.44999981, 10.39000034, 10.42000008, 10.39999962, 10.43999958, 10.34000015, 10.39000034, 10.35000038, 10.22000027, 10.18999958, 10.31999969, 10.17000008, 10.30000019, 10.36999989, 10.31999969, 10.32999992, 10.36999989, 10.35999966, 10.31999969, 10.34000015, 10.32999992, 10.35000038, 10.34000015, 10.34000015, 10.28999996, 10.26000023, 8.649999619, 8.760000229, 8.279999733, 8.350000381, 7.269999981, 7.880000114, 8.829999924, 9.100000381, 9.5, 9.380000114, 9.18999958, 9.649999619, 9.609999657, 9.779999733, 9.890000343, 9.829999924, 9.970000267, 9.93999958, 9.989999771, 10.02999973, 10.06000042, 10.03999996, 9.960000038, 9.869999886, 9.899999619, 9.890000343, 9.840000153, 9.970000267, 9.869999886, 10.02000046, 9.960000038, 9.880000114, 9.960000038, 10.09000015, 9.989999771, 10.02999973, 10.02999973, 10.02000046, 10.10999966, 10.05000019, 9.960000038, 9.970000267, 10.02999973, 10.07999992, 10.07999992, 10, 9.979999542, 10.06999969, 10.02000046, 10.07999992, 10.07999992, 10.18000031, 10.27000046, 10.22000027, 10.18999958, 10.23999977, 10.22999954, 10.17000008, 10.11999989, 10.14000034, 10.18000031, 10.19999981, 10.06000042, 9.970000267, 10, 10.06999969, 10.14000034, 10.18999958, 10.19999981, 10.27000046, 10.23999977, 10.22000027, 10.17000008, 10.14000034, 10.06999969, 10.02000046, 9.979999542, 10.01000023, 10, 9.869999886, 9.760000229, 9.789999962, 9.789999962, 9.789999962, 9.81000042, 9.800000191, 9.899999619, 9.880000114, 9.829999924, 9.800000191, 9.720000267, 9.630000114, 9.640000343, 9.56000042, 9.590000153, 9.569999695, 9.350000381, 9.170000076, 9.279999733, 9.279999733, 9.220000267, 9.170000076, 9.25, 9.300000191, 9.359999657, 9.649999619, 9.539999962, 9.760000229, 9.640000343, 9.770000458, 9.779999733, 9.840000153, 9.739999771, 9.670000076, 9.640000343, 9.659999847, 9.75, 9.829999924, 9.800000191, 9.840000153, 9.840000153, 9.850000381, 9.81000042, 9.890000343, 9.779999733, 9.770000458, 9.760000229, 9.729999542, 9.640000343, 9.710000038, 9.680000305, 9.609999657, 9.579999924, 9.579999924, 9.600000381, 9.630000114, 9.659999847, 9.720000267, 9.600000381, 9.600000381, 9.56000042, 9.520000458, 9.460000038, 9.460000038, 9.31000042, 8.979999542, 8.770000458, 8.970000267, 9.220000267, 9.25, 9.31000042, 9.279999733, 9.270000458, 9.329999924, 9.31000042, 9.329999924, 9.350000381, 9.210000038, 9.31000042, 9.170000076, 9.149999619, 9.260000229, 9.220000267, 9.149999619, 9.149999619, 9.159999847, 9.260000229, 9.270000458, 9.340000153, 9.359999657, 9.359999657, 9.300000191, 9.390000343, 9.380000114, 9.449999809, 9.399999619, 9.489999771, 9.399999619, 9.380000114, 9.430000305, 9.449999809, 9.340000153, 9.409999847, 9.390000343, 9.390000343, 9.390000343, 9.409999847, 9.380000114, 9.350000381, 9.329999924, 9.239999771, 9.270000458, 9.399999619, 9.369999886, 9.380000114, 9.430000305, 9.430000305, 9.359999657, 9.409999847, 9.369999886, 9.279999733, 9.329999924, 9.279999733, 9.180000305, 9.130000114, 9.180000305, 9.140000343, 9.220000267, 9.270000458, 9.239999771, 9.229999542, 9.170000076, 9.229999542, 9.239999771, 9.25, 9.229999542, 9.229999542, 9.18999958, 9.199999809, 9.199999809, 9.159999847, 9.159999847, 9.140000343, 9.090000153, 8.949999809, 9.010000229, 8.949999809, 8.710000038, 8.800000191, 8.520000458, 8.489999771, 8.630000114, 8.529999733, 8.670000076, 8.550000191, 8.5, 8.239999771, 8.520000458, 8.460000038, 8.510000229, 8.680000305, 8.739999771, 8.859999657, 8.630000114, 8.659999847, 8.510000229, 8.68999958, 8.779999733, 8.920000076, 8.829999924, 8.789999962, 8.779999733, 8.75, 8.630000114, 8.699999809, 8.590000153, 8.68999958, 8.699999809, 8.770000458, 8.819999695, 8.859999657, 8.850000381, 8.869999886, 8.850000381, 8.779999733, 8.779999733, 8.859999657, 8.850000381, 8.909999847, 8.829999924, 8.899999619, 8.739999771, 8.840000153, 8.789999962, 8.819999695, 8.789999962, 8.789999962, 8.75, 8.699999809, 8.729999542, 8.699999809, 8.670000076, 8.68999958, 8.720000267, 8.579999924, 8.699999809, 8.739999771, 8.81000042, 8.760000229, 8.699999809, 8.680000305, 8.640000343, 8.789999962, 8.850000381, 8.880000114, 8.930000305, 8.890000343, 8.859999657, 8.81000042, 8.720000267, 8.699999809, 8.680000305, 8.640000343, 8.649999619, 8.670000076, 8.649999619, 8.659999847, 8.640000343, 8.609999657, 8.579999924, 8.539999962, 8.539999962, 8.470000267, 8.609999657, 8.510000229, 8.579999924, 8.590000153, 8.609999657, 8.539999962, 8.449999809, 8.430000305, 8.609999657, 8.539999962, 8.590000153, 8.579999924, 8.539999962, 8.489999771, 8.510000229, 8.449999809, 8.470000267, 8.489999771, 8.550000191, 8.520000458, 8.520000458, 8.460000038, 8.550000191, 8.529999733, 8.569999695, 8.569999695, 8.569999695, 8.56000042, 8.659999847, 8.590000153, 8.609999657, 8.640000343, 8.43999958, 8.449999809, 8.409999847, 8.399999619, 8.470000267, 8.5, 8.520000458, 8.670000076, 8.75, 8.720000267, 8.579999924, 8.729999542, 8.699999809, 8.640000343, 8.68999958, 8.670000076, 8.619999886, 8.649999619, 8.680000305, 8.659999847, 8.619999886, 8.609999657, 8.600000381, 8.609999657, 8.56000042, 8.569999695, 8.550000191, 8.550000191, 8.609999657, 8.659999847, 8.640000343, 8.630000114, 8.569999695, 8.640000343, 8.640000343, 8.640000343, 8.619999886, 8.619999886, 8.539999962, 8.630000114, 8.619999886, 8.470000267, 8.390000343, 8.449999809, 8.340000153, 8.31000042, 8.369999886, 8.43999958, 8.489999771, 8.43999958, 8.399999619, 8.43999958, 8.460000038, 8.409999847, 8.329999924, 8.159999847, 8.090000153, 8.090000153, 8.130000114, 8.069999695, 8.090000153, 8.18999958, 8.050000191, 7.940000057, 7.789999962, 7.730000019, 7.860000134, 7.309999943, 7.429999828, 7.329999924, 6.929999828, 7.199999809, 7.099999905, 7.269999981, 7.010000229, 7.210000038, 7.519999981, 7.739999771, 7.989999771, 7.710000038, 7.630000114, 7.880000114, 7.829999924, 7.869999886, 8.039999962, 8.050000191, 8.029999733, 8.090000153, 8.140000343, 8.090000153, 8.020000458, 8.020000458, 8.010000229, 8.109999657, 8.140000343, 8.119999886, 8.100000381, 8.079999924, 8.090000153, 8.130000114, 8.149999619, 8.130000114, 8.170000076, 8.039999962, 8.149999619, 8.199999809, 8.170000076, 8.130000114, 8.090000153, 8.109999657, 8.090000153, 8.170000076, 8.229999542, 8.239999771, 8.199999809, 8.130000114, 8.079999924, 8.050000191, 8.039999962, 7.96999979, 8.029999733, 8.149999619, 8.149999619, 8.130000114, 8.140000343, 8.140000343, 8.170000076, 8.210000038, 8.180000305, 8.210000038, 8.170000076, 8.149999619, 8.119999886, 8.109999657, 8.079999924, 8.010000229, 7.980000019, 7.940000057, 7.869999886, 7.840000153, 8.090000153, 7.929999828, 7.949999809, 8.090000153, 8.109999657, 8.130000114, 8.149999619, 8.210000038, 8.180000305, 8.220000267, 8.229999542, 8.210000038, 7.96999979, 8.079999924, 8.079999924, 7.989999771, 8.029999733, 8.050000191, 8.029999733, 8.100000381, 8.130000114, 8.06000042, 8.06000042, 8.039999962, 8.119999886, 8.020000458, 7.989999771, 8.029999733, 8.010000229, 8.029999733, 7.980000019, 7.909999847, 7.920000076, 7.840000153, 7.920000076, 7.929999828, 7.869999886, 7.809999943, 7.710000038, 7.71999979, 7.78000021, 7.679999828, 7.730000019, 7.710000038, 7.739999771, 7.650000095, 7.579999924, 7.449999809, 7.539999962, 7.539999962, 7.639999866, 7.480000019, 7.510000229, 7.409999847, 7.400000095, 7.5, 7.429999828, 7.559999943, 7.599999905, 7.400000095, 7.550000191, 7.519999981, 7.619999886, 7.650000095, 7.670000076, 7.690000057, 7.630000114, 7.659999847, 7.679999828, 7.579999924, 7.460000038, 7.460000038, 7.449999809, 7.320000172, 7.46999979, 7.269999981, 7.239999771, 7.119999886, 7.260000229, 7.150000095, 7.039999962, 7.119999886, 7.199999809, 7.110000134, 7.289999962, 7.539999962, 7.309999943, 7.079999924, 7.130000114, 7.489999771, 7.610000134, 7.360000134, 7.239999771, 7.179999828, 7.699999809, 7.789999962, 7.769999981, 7.71999979, 7.650000095, 7.590000153, 7.489999771, 7.409999847, 7.230000019, 7.25, 7.239999771, 7.46999979, 7.559999943, 7.420000076, 7.300000191, 7.449999809, 7.449999809, 7.539999962, 7.349999905, 7.550000191, 7.46999979, 7.570000172, 7.559999943, 7.440000057, 7.489999771, 7.480000019, 7.380000114, 7.28000021, 6.960000038, 6.820000172, 6.679999828, 6.670000076, 7.070000172, 7.300000191, 7.239999771, 7.320000172, 7.760000229, 7.730000019, 7.809999943, 7.75, 7.739999771, 7.889999866, 7.989999771, 8.109999657, 7.829999924, 7.869999886, 7.849999905, 7.920000076, 7.980000019, 8.079999924, 8.149999619, 8.140000343, 8.170000076, 8.180000305, 8.170000076, 8.06000042, 8.119999886, 7.909999847, 8.170000076, 8.229999542, 8.359999657, 8.399999619, 8.390000343, 8.340000153, 8.260000229, 8.229999542, 8.159999847, 8.180000305, 8.159999847, 8.079999924, 7.96999979, 8.069999695, 7.980000019, 8.119999886, 8.090000153, 8.079999924, 8.140000343, 8.119999886, 8.069999695, 8.170000076, 8.68999958]
    depth=np.array(depth)
    tem=np.array(tem)
    meta=metaData()
    meta.levels=len(depth)
    flagt=spike_check(depth,tem,meta)
    print(flagt)

